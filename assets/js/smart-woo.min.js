let spinnerIsactive=!1;function smartWooAddSpinner(e,t=!1){if(spinnerIsactive)return;let o=t?smart_woo_vars.wp_spinner_gif_2x:smart_woo_vars.wp_spinner_gif;const n=document.createElement("div");n.setAttribute("style","position: absolute; left: 50%; top: 50%; transform: translate(-50%)"),n.innerHTML='<img src=" '+o+'" alt="Loading...">';const s=e instanceof HTMLElement?e:document.getElementById(e);return s.appendChild(n),document.body.style.setProperty("cursor","progress"),s.style.display="block",spinnerIsactive=!0,n}function smartWooRemoveSpinner(e){document.body.style.removeProperty("cursor"),e?.remove(),spinnerIsactive=!1}function showNotification(e,t=1e3){const o=document.createElement("div");o.classList.add("notification"),o.innerHTML=`\n        <div class="notification-content">\n            <span style="float:right; cursor:pointer; font-weight:bold; color: red;" class="dashicons dashicons-dismiss" onclick="this.parentElement.parentElement.remove()"></span>\n            <p>${e}</p>\n        </div>\n    `,o.style.position="fixed",o.style.top="40px",o.style.left="50%",o.style.width="400px",o.style.maxWidth="80%",o.style.fontWeight="bold",o.style.transform="translateX(-50%)",o.style.padding="15px",o.style.backgroundColor="#fff",o.style.color="#333",o.style.border="1px solid #ccc",o.style.borderRadius="5px",o.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.5)",o.style.zIndex="9999999",o.style.textAlign="center",document.body.appendChild(o),t&&setTimeout((()=>{o.remove()}),t)}function openCancelServiceDialog(e,t){var o=prompt("You can either opt out of automatic renewal of "+e+' by typing "cancel billing" or opt out of this service by typing "cancel service". This action cannot be reversed. Please note: our refund and returns policy will apply either way.\n\nPlease enter your choice:\nType "cancel service" to cancel the service\nType "cancel billing" to opt out of automatic service renewal');if(null!==o){var n=null;"cancel service"===o.toLowerCase()?n="sw_cancel_service":"cancel billing"===o.toLowerCase()&&(n="sw_cancel_billing"),null!==n?(showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_cancel_or_optout",security:smart_woo_vars.security,service_id:t,selected_action:n},success:function(){jQuery("#sw-service-quick-action").fadeIn("fast",(function(){jQuery(this).text("Done!").slideDown("fast")})),location.reload()},complete:function(){hideLoadingIndicator()}})):alert('Oops! you mis-typed it. Please type "cancel service" or "cancel billing" as instructed.')}return!1}function showLoadingIndicator(){jQuery("#swloader").css("display","block"),jQuery("body").css("cursor","progress")}function hideLoadingIndicator(){jQuery("#swloader").css("display","none"),jQuery("body").css("cursor","")}document.addEventListener("DOMContentLoaded",(function(){let e=document.getElementById("sw-service-quick-action"),t=document.getElementById("sw-forgot-pwd-btn");e&&e.addEventListener("click",(function(){openCancelServiceDialog(e.dataset.serviceName,e.dataset.serviceId)})),t&&t.addEventListener("click",(()=>{let e=document.querySelector(".sw-notice").querySelector("p"),t=document.querySelector("#sw-login-btn");e.textContent="Password Reset",t.textContent="Reset Password";let o=document.querySelector("#sw-user-login"),n=document.querySelector("#sw-user-password"),s=document.querySelector("#remember_me");o&&o.parentElement.remove(),n&&n.parentElement.remove(),s&&s.parentElement.remove();let r=document.querySelector(".smartwoo-login-form-notice"),a=document.createElement("div"),i=document.createElement("label"),c=document.createElement("input"),l=this.documentElement.querySelector("#sw-error-div");a.classList.add("smartwoo-login-form-body"),i.classList.add("smartwoo-login-form-label"),i.setAttribute("for","sw-user-login"),i.textContent="Email Address",c.setAttribute("type","text"),c.setAttribute("id","sw-user-login"),c.setAttribute("class","smartwoo-login-input"),c.setAttribute("name","user_login"),a.appendChild(i),a.appendChild(c),r.append(a),l.innerHTML='Enter your email address to request a password reset or you can <a id="sw-login-instead">Login</a> instead.',loginInstead=document.getElementById("sw-login-instead"),loginInstead&&loginInstead.addEventListener("click",(()=>{window.location.reload()})),t.addEventListener("click",(async o=>{if(o.preventDefault(),!c.value.length)return void showNotification("Email should not be empty");let n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action","smartwoo_password_reset"),n.searchParams.set("user_login",c.value),n.searchParams.set("security",smart_woo_vars.security),e.innerHTML='Password Reset processed <span class="dashicons dashicons-yes-alt" style="color: green; font-size: 25px;"></span>',a.remove(),l.innerHTML="A password reset email will be sent to the account if it exists.",t.remove();try{let e=await fetch(n,{credentials:"same-origin"});if(!e.ok)throw new Error(`Response status: ${e.status}`)}catch{}}))}))}));const smartwooClientComponentCache=new Map;async function fetchAccountComponent(e){if(smartwooClientComponentCache.has(e))return smartwooClientComponentCache.get(e);let t={billingInfo:"get_billing_details",userInfo:"get_client_details",accountLogs:"get_account_logs",orderHistory:"smartwoo_get_order_history",paymentInfo:"get_payment_details",editBilling:"get_edit_billing_form",editPrimaryPayment:"get_edit_primary_payment_form",editBackupPayment:"get_edit_backup_payment_form",editMyInfo:"get_edit_client_form",editPaymentInfo:"get_edit_payment_form"};if(!t[e])return'<div class="sw-error-notice"><p>Error: Invalid component name provided.</p></div>';let o=smartWooAddSpinner("new-smartwoo-loader",!0),n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action",t[e]),n.searchParams.set("security",smart_woo_vars.security);try{let t=await fetch(n,{credentials:"same-origin"});if(!t.ok){let e=`Something went wrong: [${t.status}] - ${t.statusText}`,o="";const n=t.headers.get("content-type");if(n&&n.includes("application/json"))try{const e=await t.json();o=JSON.stringify(e)}catch(e){o=await t.text()}else o=await t.text();let s=e;throw o&&(s+=`. Details: ${o.length<200?o:"See console for details."}`),new Error(s)}const s=await t.text();return smartwooClientComponentCache.set(e,s),setTimeout((()=>smartwooClientComponentCache.delete(e)),3e5),s}catch(e){let t="An unexpected error occurred.";return t=e instanceof TypeError?"Network error: Please check your internet connection or try again later.":e instanceof Error?e.message:`An unknown error occurred: ${String(e)}`,`<div class="sw-error-notice"><p>${t}</p></div>`}finally{smartWooRemoveSpinner(o)}}async function smartwooSubmitSettingsForm(e){if(!e)return;let t=new FormData(e);t.set("security",smart_woo_vars.security);let o=smartWooAddSpinner("new-smartwoo-loader",!0);try{let e=await fetch(smart_woo_vars.ajax_url,{method:"POST",body:t,credentials:"same-origin"});if(!e.ok){let t=`Something went wrong: [${e.status}] - ${e.statusText}`,o="";const n=e.headers.get("content-type");if(n&&n.includes("application/json"))try{const t=await e.json();o=JSON.stringify(t)}catch(t){o=await e.text()}else o=await e.text();let s=t;throw o&&(s+=`. Details: ${o.length<200?o:"See console for details."}`),new Error(s)}return await e.text()}catch(e){let t="An unexpected error occurred.";return t=e instanceof TypeError?"Network error: Please check your internet connection or try again later.":e instanceof Error?e.message:`An unknown error occurred: ${String(e)}`,`<div class="sw-error-notice"><p>${t}</p></div>`}finally{smartWooRemoveSpinner(o),smartwooClientComponentCache.clear()}}function smartwoo_ajax_logout(){let e=document.querySelector(".smartwoo-logout-contaner"),t=document.createElement("div");t.id="spinnerDiv",e.appendChild(t);let o=smartWooAddSpinner("spinnerDiv");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{security:smart_woo_vars.security,action:"smartwoo_ajax_logout"},complete:function(){o.remove(),window.location.reload()}})}document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("smartwooConfigureProduct"),t=document.querySelector(".sw-blue-button");e&&t&&e.addEventListener("submit",(function(o){o.preventDefault();var n=t.textContent;t.textContent="Processing...",t.disabled=!0;var s=new FormData(e);s.append("action","smartwoo_configure_product"),s.append("security",smart_woo_vars.security),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:s,processData:!1,contentType:!1,success:function(e){if(e.success&&e.data){var o=e.data.checkout;t.textContent="Product is configured, redirecting to checkout page....",window.location.href=o}else jQuery("#error-container").html(e.data.message),t.textContent=n},error:function(e,o,s){t.textContent=n}})}))})),document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelector(".sw-menu-icon"),t=document.querySelector(".service-navbar"),o=document.querySelector(".smart-woo-logout"),n=document.getElementById("smartwoo-login-form-visible"),s=document.getElementById("smartwoo-login-form-invisible"),r=document.getElementById("sw-user-password"),a=document.querySelectorAll(".sw-admin-service-assets-button, .sw-client-service-assets-button"),i=document.querySelector(".smartwoo-service-renew-button"),c=document.querySelectorAll(".sw-user-status-item"),l=document.querySelector(".mini-card-content"),d=document.querySelector("#smartwooSettingsContainer"),u=document.getElementById("smartwoo-assets-sub-nav");if(e){let o=e.querySelector(".dashicons-menu"),n=document.querySelector(".dashicons.dashicons-no-alt.sw-close-icon");e.addEventListener("click",(function(){t.classList.toggle("active"),t.classList.contains("active")?(jQuery(n).show(),n.focus(),o.classList.remove("dashicons-menu"),o.classList.add("dashicons-no")):(o.classList.remove("dashicons-no"),o.classList.add("dashicons-menu"),jQuery(n).hide())})),n.addEventListener("click",(t=>{t.preventDefault(),e.click()}))}if(c.length&&c.forEach((e=>{e.style.cursor="pointer";let t=e.querySelector("a").getAttribute("href");e.addEventListener("click",(()=>{window.location.href=t}))})),o){let e=!1;o.addEventListener("click",(function(){if(e)jQuery(".smartwoo-logout-frame").fadeOut("slow",(()=>{document.querySelector(".smartwoo-logout-frame").remove()}));else{let o=document.createElement("div");o.classList.add("smartwoo-logout-frame");let n=document.createElement("div");n.classList.add("smartwoo-logout-contaner"),o.append(n);let s=document.createElement("p");s.textContent="Are sure you want to logout?",n.append(s);let r=document.createElement("div");r.classList.add("smartwoo-logout-btn-container");let a=document.createElement("button");a.classList.add("sw-blue-button"),a.innerHTML='<span class="dashicons dashicons-yes"></span>';let i=document.createElement("button");i.classList.add("sw-red-button"),i.innerHTML='<span class="dashicons dashicons-no-alt"></span>',r.append(i,a),n.append(r),t.insertAdjacentElement("afterend",o),jQuery(o).fadeIn().css("display","block"),i.addEventListener("click",(()=>{jQuery(o).fadeOut("slow",(()=>{o.remove()})),e=!e})),a.addEventListener("click",smartwoo_ajax_logout),o.addEventListener("click",(e=>{e.target===o&&i.click()}))}e=!e}))}if(n&&s&&r&&(n.addEventListener("click",(()=>{n.style.display="none",s.style.display="block",r.setAttribute("type","text")})),s.addEventListener("click",(()=>{s.style.display="none",n.style.display="block",r.setAttribute("type","password")}))),a.length){let e=document.querySelectorAll(".sw-admin-assets-body-content, .sw-client-assets-body-content"),t=()=>{a.forEach((e=>{e.classList.remove("active")})),e.forEach((e=>{e.classList.add("smartwoo-hide")}))};a.forEach(((o,n)=>{o.addEventListener("click",(o=>{t(),o.target.classList.contains("active")||o.target.classList.add("active"),e[n].classList.toggle("smartwoo-hide")}))}))}if(i&&i.addEventListener("click",(e=>{e.preventDefault(),jQuery("#swloader").show().css("background-color","rgba(129, 128, 128, 0)").text("");let t=smartWooAddSpinner("swloader",!0),o=i.getAttribute("data-service-id"),n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action","smartwoo_manual_renew"),n.searchParams.set("service_id",o),n.searchParams.set("security",smart_woo_vars.security),fetch(n,{credentials:"same-origin"}).then((e=>(e.ok||showNotification("Something went wrong...",6e3),e.json()))).then((e=>{e.success?(showNotification(e.data.message,3e3),setTimeout((()=>{window.location.href=e.data.redirect_url}),3e3)):(showNotification(e.data.message??"Operation was not successful",3e3),setTimeout((()=>{window.location.reload()}),3e3))})).catch((e=>{})).finally((()=>{smartWooRemoveSpinner(t),jQuery("#swloader").hide()}))})),l){let e=document.querySelector(".sw-mini-card-pagination"),t=e.querySelectorAll("button"),o=t[0],n=t[1],s="any",r=l.getAttribute("limit");smart_woo_vars.is_account_page&&(s="myaccount");let a=(t,r)=>{t=Number(t),l.innerHTML='\n\t\t\t\t<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>\n\t\t\t\t<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>\n\t\t\t\t<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>\n\t\t\t\t<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>\n\t\t\t\t<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>\n\t\t\t';let a=new URL(smart_woo_vars.ajax_url);a.searchParams.set("action","get_subscriptions"),a.searchParams.set("limit",r),a.searchParams.set("security",smart_woo_vars.security),a.searchParams.set("context",s),a.searchParams.set("page",t),fetch(a,{credentials:"same-origin"}).then((e=>{if(!e.ok)throw new Error(`Error unable to fetch service subscriptions [${e.statusText}]`);return e.json()})).then((s=>{let r=s.data.subscriptions??[],a=s.data.pagination;if(l.innerHTML="",r.length?r.forEach((e=>{let t=document.createElement("li");t.innerHTML=`<a href="${e.view_url}" data-status="(${e.status})">${e.name}</a>`,l.appendChild(t)})):l.innerHTML=`<li>${s.data.message}</li>`,a.total_items>=1){if(e.classList.add("has-more"),document.querySelector("#sw-card-counter").textContent=`${a.total_items} items ${t} of ${a.total_pages}`,t>1){let e=t-1;o.setAttribute("page",e),jQuery(o).show()}else jQuery(o).hide();if(t<a.total_pages){let e=t+1;n.setAttribute("page",e),jQuery(n).show()}else jQuery(n).hide()}}))};n.addEventListener("click",(()=>{let e=n.getAttribute("page");a(e,r)})),o.addEventListener("click",(()=>{let e=o.getAttribute("page");a(e,r)})),a(1,r)}if(d){let e=null,t=document.querySelector("#ajax-content-container");d.addEventListener("click",(async o=>{if(o.target.closest(".clear-radio"))return void o.target.closest("form").querySelectorAll('input[type="radio"]').forEach((e=>e.checked=!1));const n=o.target.closest("#sw-billing-details, #sw-load-user-details, #sw-account-log, #sw-load-order-history, #edit-billing-address, #edit-account-button, #view-payment-button, .smartwoo-inline-edit");if(!n)return;const s=n.getAttribute("data-action");if(!s)return;if(s===e)return;e=s;let r=await fetchAccountComponent(s);jQuery(t).fadeOut("slow",(()=>{jQuery(t).html(r),jQuery(t).fadeIn("slow",(()=>{"editBilling"===s&&(jQuery(document.body).trigger("wc_country_select_init"),jQuery(document.body).trigger("wc-enhanced-select-init"),jQuery(document.body).trigger("country_to_state_changed"))}))}))})),d.addEventListener("submit",(async o=>{e=null,o.preventDefault(),o.target.querySelector('button[type="submit"]')?.setAttribute("disabled",!0);let n=await smartwooSubmitSettingsForm(o.target);o.target.querySelector('button[type="submit"]')?.removeAttribute("disabled"),jQuery(t).fadeOut("slow",(()=>{jQuery(t).html(n),jQuery(t).fadeIn()}))}))}if(u){var m=document.getElementById("smartwoo-sub-info"),p=document.getElementById("smartwoo-sub-assets"),y=u.innerHTML,w=!1;u.addEventListener("click",(function(e){w?(u.innerHTML=y,jQuery(m).fadeIn().css("display","flex"),p.style.display="none"):(u.innerHTML='<span class="dashicons dashicons-info-outline"></span> Sub Info',m.style.display="none",jQuery(p).fadeIn().css("display","block")),w=!w}))}})),addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("smartwooUpdateBtn");e&&e.addEventListener("click",(function(){var t=document.getElementById("smartwooNoticeDiv"),o=document.createElement("div"),n=document.createElement("p");o.className="notice notice-success is-dismissible",e.textContent="";var s=smartWooAddSpinner("smartwooUpdateBtn");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_db_update",security:smart_woo_vars.security},success:function(e){n.textContent=e.success?e.data.message:"Background update started",o.appendChild(n),t.replaceWith(o)},error:function(e){e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?e.responseJSON.data.message:e.responseText&&e.responseText},complete:function(){smartWooRemoveSpinner(s)}})}))}));