let spinnerIsactive=!1;function smartWooAddSpinner(e,t=!1){if(spinnerIsactive)return;let s=t?smart_woo_vars.wp_spinner_gif_2x:smart_woo_vars.wp_spinner_gif,n=document.createElement("div");n.setAttribute("style","position: absolute; left: 50%; top: 50%; transform: translate(-50%)"),n.innerHTML='<img src=" '+s+'" alt="Loading...">';let a=e instanceof HTMLElement?e:document.getElementById(e);return a.appendChild(n),document.body.style.setProperty("cursor","progress"),a.style.display="block",spinnerIsactive=!0,n}function smartWooRemoveSpinner(e){document.body.style.removeProperty("cursor"),e?.remove(),spinnerIsactive=!1}function showNotification(e,t=1e3){let s=document.createElement("div");s.classList.add("notification"),s.innerHTML=`
        <div class="notification-content">
            <span style="float:right; cursor:pointer; font-weight:bold; color: red;" class="dashicons dashicons-dismiss" onclick="this.parentElement.parentElement.remove()"></span>
            <p>${e}</p>
        </div>
    `,s.style.position="fixed",s.style.top="40px",s.style.left="50%",s.style.width="30%",s.style.fontWeight="bold",s.style.transform="translateX(-50%)",s.style.padding="15px",s.style.backgroundColor="#fff",s.style.color="#333",s.style.border="1px solid #ccc",s.style.borderRadius="5px",s.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.5)",s.style.zIndex="9999999",s.style.textAlign="center",document.body.appendChild(s),t&&setTimeout(()=>{s.remove()},t)}function openCancelServiceDialog(e,t){var s=prompt("You can either opt out of automatic renewal of "+e+' by typing "cancel billing" or opt out of this service by typing "cancel service". This action cannot be reversed. Please note: our refund and returns policy will apply either way.\n\nPlease enter your choice:\nType "cancel service" to cancel the service\nType "cancel billing" to opt out of automatic service renewal');if(null!==s){var n=null;"cancel service"===s.toLowerCase()?n="sw_cancel_service":"cancel billing"===s.toLowerCase()&&(n="sw_cancel_billing"),null!==n?(showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_cancel_or_optout",security:smart_woo_vars.security,service_id:t,selected_action:n},success:function(){jQuery("#sw-service-quick-action").fadeIn("fast",function(){jQuery(this).text("Done!").slideDown("fast")}),location.reload()},complete:function(){hideLoadingIndicator()}})):alert('Oops! you mis-typed it. Please type "cancel service" or "cancel billing" as instructed.')}return!1}function showLoadingIndicator(){jQuery("#swloader").css("display","block"),jQuery("body").css("cursor","progress")}function hideLoadingIndicator(){jQuery("#swloader").css("display","none"),jQuery("body").css("cursor","")}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("sw-service-quick-action"),t=document.getElementById("sw-forgot-pwd-btn");e&&e.addEventListener("click",function(){let t;openCancelServiceDialog(e.dataset.serviceName,e.dataset.serviceId)}),t&&t.addEventListener("click",()=>{let e=document.querySelector(".sw-notice").querySelector("p"),t=document.querySelector("#sw-login-btn");e.textContent="Password Reset",t.textContent="Reset Password";let s=document.querySelector("#sw-user-login"),n=document.querySelector("#sw-user-password"),a=document.querySelector("#remember_me");s&&s.parentElement.remove(),n&&n.parentElement.remove(),a&&a.parentElement.remove();let o=document.querySelector(".smartwoo-login-form-notice"),r=document.createElement("div"),i=document.createElement("label"),l=document.createElement("input"),c=this.documentElement.querySelector("#sw-error-div");r.classList.add("smartwoo-login-form-body"),i.classList.add("smartwoo-login-form-label"),i.setAttribute("for","sw-user-login"),i.textContent="Email Address",l.setAttribute("type","text"),l.setAttribute("id","sw-user-login"),l.setAttribute("class","smartwoo-login-input"),l.setAttribute("name","user_login"),r.appendChild(i),r.appendChild(l),o.append(r),c.innerHTML='Enter your email address to request a password reset or you can <a id="sw-login-instead">Login</a> instead.',(loginInstead=document.getElementById("sw-login-instead"))&&loginInstead.addEventListener("click",()=>{window.location.reload()}),t.addEventListener("click",async s=>{if(s.preventDefault(),!l.value.length){showNotification("Email should not be empty");return}let n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action","smartwoo_password_reset"),n.searchParams.set("user_login",l.value),n.searchParams.set("security",smart_woo_vars.security),e.innerHTML='Password Reset processed <span class="dashicons dashicons-yes-alt" style="color: green; font-size: 25px;"></span>',r.remove(),c.innerHTML="A password reset email will be sent to the account if it exists.",t.remove();try{let a=await fetch(n,{credentials:"same-origin"});if(!a.ok)throw Error(`Response status: ${a.status}`)}catch{}})})});const smartwooClientComponentCache=new Map;async function fetchAccountComponent(e){if(smartwooClientComponentCache.has(e))return smartwooClientComponentCache.get(e);let t={billingInfo:"get_billing_details",userInfo:"get_client_details",accountLogs:"get_account_logs",orderHistory:"smartwoo_get_order_history",paymentInfo:"get_payment_details",editBilling:"get_edit_billing_form",editPrimaryPayment:"get_edit_primary_payment_form",editBackupPayment:"get_edit_backup_payment_form",editMyInfo:"get_edit_client_form",editPaymentInfo:"get_edit_payment_form"};if(!t[e])return'<div class="sw-error-notice"><p>Error: Invalid component name provided.</p></div>';let s=smartWooAddSpinner("new-smartwoo-loader",!0),n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action",t[e]),n.searchParams.set("security",smart_woo_vars.security);try{let a=await fetch(n,{credentials:"same-origin"});if(!a.ok){let o=`Something went wrong: [${a.status}] - ${a.statusText}`,r="",i=a.headers.get("content-type");if(i&&i.includes("application/json"))try{let l=await a.json();r=JSON.stringify(l)}catch(c){r=await a.text()}else r=await a.text();let d=o;throw r&&(d+=`. Details: ${r.length<200?r:"See console for details."}`),Error(d)}let u=await a.text();return smartwooClientComponentCache.set(e,u),setTimeout(()=>smartwooClientComponentCache.delete(e),3e5),u}catch(m){let p="An unexpected error occurred.";return`<div class="sw-error-notice"><p>${p=m instanceof TypeError?"Network error: Please check your internet connection or try again later.":m instanceof Error?m.message:`An unknown error occurred: ${String(m)}`}</p></div>`}finally{smartWooRemoveSpinner(s)}}async function smartwooSubmitSettingsForm(e){if(!e)return console.warn("Invalid form element");let t=new FormData(e);t.set("security",smart_woo_vars.security);let s=smartWooAddSpinner("new-smartwoo-loader",!0);try{let n=await fetch(smart_woo_vars.ajax_url,{method:"POST",body:t,credentials:"same-origin"});if(!n.ok){let a=`Something went wrong: [${n.status}] - ${n.statusText}`,o="",r=n.headers.get("content-type");if(r&&r.includes("application/json"))try{let i=await n.json();o=JSON.stringify(i)}catch(l){o=await n.text()}else o=await n.text();let c=a;throw o&&(c+=`. Details: ${o.length<200?o:"See console for details."}`),Error(c)}return await n.text()}catch(d){let u="An unexpected error occurred.";return`<div class="sw-error-notice"><p>${u=d instanceof TypeError?"Network error: Please check your internet connection or try again later.":d instanceof Error?d.message:`An unknown error occurred: ${String(d)}`}</p></div>`}finally{smartWooRemoveSpinner(s),smartwooClientComponentCache.clear()}}function smartwoo_ajax_logout(){let e=document.querySelector(".smartwoo-logout-contaner"),t=document.createElement("div");t.id="spinnerDiv",e.appendChild(t);let s=smartWooAddSpinner("spinnerDiv");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{security:smart_woo_vars.security,action:"smartwoo_ajax_logout"},complete:function(){s.remove(),window.location.reload()}})}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwooConfigureProduct"),t=document.querySelector(".sw-blue-button");e&&t&&e.addEventListener("submit",function(s){s.preventDefault();var n=t.textContent;t.textContent="Processing...",t.disabled=!0;var a=new FormData(e);a.append("action","smartwoo_configure_product"),a.append("security",smart_woo_vars.security),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:a,processData:!1,contentType:!1,success:function(e){if(e.success&&e.data){var s=e.data.checkout;t.textContent="Product is configured, redirecting to checkout page....",window.location.href=s}else jQuery("#error-container").html(e.data.message),t.textContent=n},error:function(e,s,a){console.error(a),t.textContent=n}})})}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".sw-menu-icon"),t=document.querySelector(".service-navbar"),s=document.querySelector(".smart-woo-logout"),n=document.getElementById("smartwoo-login-form-visible"),a=document.getElementById("smartwoo-login-form-invisible"),o=document.getElementById("sw-user-password"),r=document.querySelectorAll(".sw-admin-service-assets-button, .sw-client-service-assets-button"),i=document.querySelector(".smartwoo-service-renew-button"),l=document.querySelectorAll(".sw-user-status-item"),c=document.querySelector(".mini-card-content"),d=document.querySelector("#smartwooSettingsContainer"),u=document.getElementById("smartwoo-assets-sub-nav");if(e){let m=e.querySelector(".dashicons-menu"),p=document.querySelector(".dashicons.dashicons-no-alt.sw-close-icon");e.addEventListener("click",function(){t.classList.toggle("active"),t.classList.contains("active")?(jQuery(p).show(),p.focus(),m.classList.remove("dashicons-menu"),m.classList.add("dashicons-no")):(m.classList.remove("dashicons-no"),m.classList.add("dashicons-menu"),jQuery(p).hide())}),p.addEventListener("click",t=>{t.preventDefault(),e.click()})}if(l.length&&l.forEach(e=>{e.style.cursor="pointer";let t=e.querySelector("a").getAttribute("href");e.addEventListener("click",()=>{window.location.href=t})}),s){let y=!1;s.addEventListener("click",function(){if(y)jQuery(".smartwoo-logout-frame").fadeOut("slow",()=>{document.querySelector(".smartwoo-logout-frame").remove()});else{let e=document.createElement("div");e.classList.add("smartwoo-logout-frame");let s=document.createElement("div");s.classList.add("smartwoo-logout-contaner"),e.append(s);let n=document.createElement("p");n.textContent="Are sure you want to logout?",s.append(n);let a=document.createElement("div");a.classList.add("smartwoo-logout-btn-container");let o=document.createElement("button");o.classList.add("sw-blue-button"),o.innerHTML='<span class="dashicons dashicons-yes"></span>';let r=document.createElement("button");r.classList.add("sw-red-button"),r.innerHTML='<span class="dashicons dashicons-no-alt"></span>',a.append(r,o),s.append(a),t.insertAdjacentElement("afterend",e),jQuery(e).fadeIn().css("display","block"),r.addEventListener("click",()=>{jQuery(e).fadeOut("slow",()=>{e.remove()}),y=!y}),o.addEventListener("click",smartwoo_ajax_logout),e.addEventListener("click",t=>{t.target===e&&r.click()})}y=!y})}if(n&&a&&o&&(n.addEventListener("click",()=>{n.style.display="none",a.style.display="block",o.setAttribute("type","text")}),a.addEventListener("click",()=>{a.style.display="none",n.style.display="block",o.setAttribute("type","password")})),r.length){let w=document.querySelectorAll(".sw-admin-assets-body-content, .sw-client-assets-body-content"),g=()=>{r.forEach(e=>{e.classList.remove("active")}),w.forEach(e=>{e.classList.add("smartwoo-hide")})};r.forEach((e,t)=>{e.addEventListener("click",e=>{g(),e.target.classList.contains("active")||e.target.classList.add("active"),w[t].classList.toggle("smartwoo-hide")})})}if(i&&i.addEventListener("click",e=>{e.preventDefault(),jQuery("#swloader").show().css("background-color","rgba(129, 128, 128, 0)").text("");let t=smartWooAddSpinner("swloader",!0),s=i.getAttribute("data-service-id"),n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action","smartwoo_manual_renew"),n.searchParams.set("service_id",s),n.searchParams.set("security",smart_woo_vars.security),fetch(n,{credentials:"same-origin"}).then(e=>(e.ok||(console.error(e.statusText),showNotification("Something went wrong...",6e3)),e.json())).then(e=>{e.success?(showNotification(e.data.message,3e3),setTimeout(()=>{window.location.href=e.data.redirect_url},3e3)):(showNotification(e.data.message??"Operation was not successful",3e3),setTimeout(()=>{window.location.reload()},3e3))}).catch(e=>{console.error(e.message)}).finally(()=>{smartWooRemoveSpinner(t),jQuery("#swloader").hide()})}),c){let f=document.querySelector(".sw-mini-card-pagination"),h=f.querySelectorAll("button"),v=h[0],b=h[1],E="any",L=c.getAttribute("limit");smart_woo_vars.is_account_page&&(E="myaccount");let x=(e,t)=>{e=Number(e),c.innerHTML=`
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
			`;let s=new URL(smart_woo_vars.ajax_url);s.searchParams.set("action","get_subscriptions"),s.searchParams.set("limit",t),s.searchParams.set("security",smart_woo_vars.security),s.searchParams.set("context",E),s.searchParams.set("page",e),fetch(s,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw Error(`Error unable to fetch service subscriptions [${e.statusText}]`);return e.json()}).then(t=>{let s=t.data.subscriptions??[],n=t.data.pagination;if(c.innerHTML="",s.length?s.forEach(e=>{let t=document.createElement("li");t.innerHTML=`<a href="${e.view_url}" data-status="(${e.status})">${e.name}</a>`,c.appendChild(t)}):c.innerHTML=`<li>${t.data.message}</li>`,n.total_items>=1){if(f.classList.add("has-more"),document.querySelector("#sw-card-counter").textContent=`${n.total_items} items ${e} of ${n.total_pages}`,e>1){let a=e-1;v.setAttribute("page",a),jQuery(v).show()}else jQuery(v).hide();if(e<n.total_pages){let o=e+1;b.setAttribute("page",o),jQuery(b).show()}else jQuery(b).hide()}})};b.addEventListener("click",()=>{x(b.getAttribute("page"),L)}),v.addEventListener("click",()=>{x(v.getAttribute("page"),L)}),x(1,L)}if(d){let S=null,k=document.querySelector("#ajax-content-container");d.addEventListener("click",async e=>{if(e.target.closest(".clear-radio")){e.target.closest("form").querySelectorAll('input[type="radio"]').forEach(e=>e.checked=!1);return}let t=e.target.closest("#sw-billing-details, #sw-load-user-details, #sw-account-log, #sw-load-order-history, #edit-billing-address, #edit-account-button, #view-payment-button, .smartwoo-inline-edit");if(!t)return;let s=t.getAttribute("data-action");if(!s)return console.warn("button action not found");if(s===S)return;S=s;let n=await fetchAccountComponent(s);jQuery(k).fadeOut("slow",()=>{jQuery(k).html(n),jQuery(k).fadeIn("slow",()=>{"editBilling"===s&&(jQuery(document.body).trigger("wc_country_select_init"),jQuery(document.body).trigger("wc-enhanced-select-init"),jQuery(document.body).trigger("country_to_state_changed"))})})}),d.addEventListener("submit",async e=>{S=null,e.preventDefault(),e.target.querySelector('button[type="submit"]')?.setAttribute("disabled",!0);let t=await smartwooSubmitSettingsForm(e.target);e.target.querySelector('button[type="submit"]')?.removeAttribute("disabled"),jQuery(k).fadeOut("slow",()=>{jQuery(k).html(t),jQuery(k).fadeIn()})})}if(u){var C=document.getElementById("smartwoo-sub-info"),$=document.getElementById("smartwoo-sub-assets"),A=u.innerHTML,I=!1;u.addEventListener("click",function(e){I?(u.innerHTML=A,jQuery(C).fadeIn().css("display","flex"),$.style.display="none"):(u.innerHTML='<span class="dashicons dashicons-info-outline"></span> Sub Info',C.style.display="none",jQuery($).fadeIn().css("display","block")),I=!I})}}),addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwooUpdateBtn");e&&e.addEventListener("click",function(){var t=document.getElementById("smartwooNoticeDiv"),s=document.createElement("div"),n=document.createElement("p");s.className="notice notice-success is-dismissible",e.textContent="";var a=smartWooAddSpinner("smartwooUpdateBtn");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_db_update",security:smart_woo_vars.security},success:function(e){n.textContent=e.success?e.data.message:"Background update started",s.appendChild(n),t.replaceWith(s)},error:function(e){var t="Error updating the database: ";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?t+=e.responseJSON.data.message:e.responseText?t+=e.responseText:t+=e,console.error(t)},complete:function(){smartWooRemoveSpinner(a)}})})});