function smartwooFastCheckout(){let e=document.querySelectorAll(".product_type_sw_product.add_to_cart_button");e.length&&e.forEach((e=>{e.addEventListener("click",smartwooOpenModal)}))}function smartwooOpenModal(e){let t=e.target.closest("li"),o=smart_woo_vars.fast_checkout_config;t||(t=e.target.closest(".configure-product-button"));let r=t.querySelector(".smartwoo-product-data");if(!r)return;e.preventDefault();let n=r.getAttribute("smartwoo-product-config"),a=JSON.parse(n),d=a.id,s=document.querySelector(".sw-fast-checkout-main"),l=()=>{modal=document.querySelector(".smartwoo-modal-frame"),jQuery(modal).fadeOut("fast",(()=>{modal.remove()}))};s&&l();let c=document.createElement("div"),i=document.createElement("div"),u=document.createElement("span"),m=document.createElement("h3"),p=document.createElement("div");c.classList.add("smartwoo-modal-frame"),i.setAttribute("style",`background-color: ${o.modal_background_color};`),c.appendChild(i);let y=o.title.replace("{{product_name}}",`"${a.name}"`||"");m.textContent=y,m.setAttribute("style",`padding: 5px; color: ${o.title_color}`),m.style.padding="5px";let h=`\n        <div id="response"></div>\n        <div class="smartwoo-fast-checkout-description">\n            <img src="${a.image_url}" alt="${a.name}">\n            <span>${o.description}</span>\n        </div>\n        <input type="text" name="service_name" id="service_name" placeholder="${o.service_name_placeholder}"/>\n        <input type="text" name="service_url" id="service_url" placeholder="${o.url_placeholder}"/>\n        <button class="sw-blue-button" style="background-color: ${o.button_background_color}; color: ${o.button_text_color};">${o.checkout_button_text}</button>\n        <div id="loader" style="background-color:rgba(255, 255, 255, 0); text-align: center; display: none;"></div>\n\n    `;u.setAttribute("style","float: right; color:rgb(248, 100, 100); margin-right: 4px; cursor: pointer; font-size: 24px"),u.setAttribute("class","dashicons dashicons-dismiss"),i.classList.add("sw-fast-checkout-main"),p.classList.add("sw-flex-column"),p.style.position="relative",p.innerHTML=h,m.appendChild(u),i.appendChild(m),i.appendChild(p),document.body.prepend(c),jQuery(c).fadeIn("slow"),u.addEventListener("click",(()=>{l()})),c.addEventListener("click",(e=>{e.target===c&&l()}));let v=e=>{"Escape"!==e.key&&"Esc"!==e.key||(l(),document.removeEventListener("keydown",v))};document.addEventListener("keydown",v);let f=i.querySelector("#response");f.style.border="solid 1px #dcdcde",f.style.padding="5px",f.style.minHeight="40px",f.style.display="none";let _,b=i.querySelector("button");b.addEventListener("click",(e=>{jQuery(f).fadeOut(),b.setAttribute("disabled",!0);let t=i.querySelector("#service_name"),o=i.querySelector("#service_url");if(!t.value.trim().length)return f.innerHTML="Please enter a service name",jQuery(f).fadeIn(),void b.removeAttribute("disabled");_||(_=smartWooAddSpinner("loader",!0)),jQuery(_).show();let r=(e=>{let t=[" #ffffff"," #e2def5","rgb(129, 122, 122)"," #b3afaf","rgb(61, 196, 250)"];return setInterval((()=>{e.style.backgroundColor=t[Math.floor(Math.random()*t.length)]}),200)})(i);_.style.position="absolute",_.style.top="20%",_.style.left="40%";let n=new FormData;n.append("security",smart_woo_vars.security),n.append("product_id",d),n.append("service_name",t.value),n.append("service_url",o.value),n.append("action","smartwoo_configure_product"),fetch(smart_woo_vars.ajax_url,{method:"POST",body:n}).then((e=>{if(!e.ok)throw f.innerHTML="Request cannot be completed",f.style.border="solid 1px #dcdcde",new Error(e.statusText,6e3);return e.json()})).then((e=>{e.success?(f.style.border="solid 1px #dcdcde",f.innerHTML=e.data.message?e.data.message:"Product configured, redirecting to checkout.",window.location.href=e.data.checkout,jQuery(f).show()):(f.innerHTML=e.data.message?e.data.message:"Something went wrong.",jQuery(f).show())})).catch((e=>{jQuery(f).show()})).finally((()=>{jQuery(_).hide(),b.removeAttribute("disabled"),clearInterval(r)}))}))}document.addEventListener("DOMContentLoaded",smartwooFastCheckout);