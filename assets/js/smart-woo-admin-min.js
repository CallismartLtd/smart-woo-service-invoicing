function renderTable(e,t,a,n,r,o){let s={},l=document.querySelector(".sw-admin-dash-body"),i=document.querySelector(".sw-search-container");smartwooRemoveTable(),addPaginationControls(i,n,r,totalItems=t.length,o);let c=document.createElement("table");c.classList.add("sw-table");let d=document.createElement("thead"),u=document.createElement("tr"),p=document.createElement("th"),m=document.createElement("input");m.type="checkbox",m.addEventListener("change",function(){h.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.checked=this.checked,s[e.name]=this.checked}),f()}),p.appendChild(m),u.appendChild(p),e.forEach(e=>{let t=document.createElement("th");t.textContent=e,u.appendChild(t)}),d.appendChild(u),c.appendChild(d);let h=document.createElement("tbody");if(0===t.length){let v=document.createElement("tr"),y=document.createElement("td");y.colSpan=e.length+1,y.textContent="No service found.",y.classList.add("sw-not-found"),v.appendChild(y),h.appendChild(v)}else t.forEach((e,t)=>{let n=document.createElement("tr"),r=document.createElement("td"),o=document.createElement("input");o.type="checkbox",o.name=a[t],s[o.name]&&(o.checked=!0),o.addEventListener("change",function(){s[this.name]=this.checked,this.checked||(m.checked=!1);Array.from(h.querySelectorAll('input[type="checkbox"]')).every(e=>e.checked)&&(m.checked=!0),f()}),r.appendChild(o),n.appendChild(r),e.forEach((e,t)=>{let a=document.createElement("td");a.textContent=e,1===t&&(a.classList.add("service-id-column"),a.style.cursor="pointer",a.addEventListener("click",function(){smartwoo_service_admin_view(e)})),n.appendChild(a)}),h.appendChild(n)});function f(){let e=[];if(h.querySelectorAll('input[type="checkbox"]:checked').forEach(t=>e.push(t.name)),e.length>0)smartwooShowActionDialog(e);else{let t=document.querySelector(".sw-action-container");t&&t.remove()}}c.appendChild(h),l.appendChild(c),addPaginationControls(l,n,r,totalItems,o)}function addPaginationControls(e,t,a,n,r){let o=document.createElement("div");o.classList.add("sw-pagination-buttons"),o.style.float="right";let s=document.createElement("p");if(s.textContent=`${n} items`,o.appendChild(s),a>1){let l=a-1,i=document.createElement("a");i.classList.add("sw-pagination-button");let c=document.createElement("button");c.innerHTML='<span class="dashicons dashicons-arrow-left-alt2"></span>',i.appendChild(c),i.addEventListener("click",function(e){e.preventDefault(),fetchDashboardData(r,{paged:l})}),o.appendChild(i)}let d=document.createElement("p");if(d.textContent=`${a} of ${t}`,o.appendChild(d),a<t){let u=a+1,p=document.createElement("a");p.classList.add("sw-pagination-button");let m=document.createElement("button");m.innerHTML='<span class="dashicons dashicons-arrow-right-alt2"></span>',p.appendChild(m),p.addEventListener("click",function(e){e.preventDefault(),fetchDashboardData(r,{paged:u})}),o.appendChild(p)}e.appendChild(o)}function smartwoo_service_admin_view(e){let t=new URL(smartwoo_admin_vars.sw_admin_page);t.searchParams.set("action","view-service"),t.searchParams.set("service_id",e),t.searchParams.set("tab","details"),window.location.href=t.href}function smartwooRemoveTable(){let e=document.querySelector(".sw-table"),t=document.querySelectorAll(".sw-pagination-buttons");e&&(jQuery(".sw-table").fadeOut(),setTimeout(()=>{e.remove()},1e3),t&&t.forEach(e=>{e.remove()}))}function smartwooPostBulkAction(e,t=[]){if("delete"!==e||confirm("Warning: You are about to delete the selected service"+(t.length>1?"s":"")+", along with all related invoices and assets. Click OK to confirm."))showLoadingIndicator(),jQuery.ajax({type:"POST",url:smartwoo_admin_vars.ajax_url,data:{action:"smartwoo_dashboard_bulk_action",service_ids:t,real_action:e,security:smartwoo_admin_vars.security},success:function(e){e.success?(showNotification(e.data.message),setTimeout(()=>{window.location.reload()},2e3)):showNotification("Oops! "+e.data.message)},error:function(e,t,a){console.error("Bulk action failed:",a),showNotification("An error occured, please inspect console.")},complete:function(){let e=document.querySelector(".sw-action-container");e&&e.remove(),hideLoadingIndicator()}})}function smartwooShowActionDialog(e){let t=document.querySelector(".sw-action-container");t&&t.remove();let a=document.createElement("div");a.classList.add("sw-action-container"),a.innerHTML=`
      <select id="sw-action-select" name="dash_bulk_action">
        <option selected>Choose Action</option>
        <option value="auto_calc">Auto Calculate</option>
        <option value="Active">Activate</option>
        <option value="Active (NR)">Disable Renewal</option>
        <option value="Suspended">Suspend Service</option>
        <option value="Cancelled">Cancel Service</option>
        <option value="Due for Renewal">Due for Renewal</option>
        <option value="Expired">Expired</option>
        <option value="delete">Delete</option>
      </select>
      <input type="hidden" name="service_ids" value="${e}"/>
    `;let n=document.querySelector(".sw-table");n.prepend(a),jQuery(".sw-action-container").fadeIn().css("display","flex"),a.addEventListener("change",()=>{let t=a.querySelector("select").value,n=document.querySelector(".sw-action-btn");n&&n.remove();let r=document.createElement("button");r.classList.add("sw-action-btn"),r.textContent="Apply Action",r.style.backgroundColor="#f1f1f1f1",r.style.marginLeft="-2px",r.style.height="30px",r.style.border="solid .5px blue","Choose Action"!==t&&(a.append(r),jQuery(r).fadeIn()),r&&r.addEventListener("click",()=>{smartwooPostBulkAction(t,e)})})}let fetchIntervals={};function fetchServiceCount(e,t,a){let n=document.querySelectorAll(".sw-dash-content");return jQuery.ajax({type:"GET",url:smartwoo_admin_vars.ajax_url,data:{action:"smartwoo_dashboard",real_action:t,security:smartwoo_admin_vars.security},success:function(r){if(r.success){smartwoo_clear_dash_content(e);let o=document.createElement("div"),s=document.createElement("h2"),l=document.createElement("span");o.classList.add("sw-dash-count"),s.textContent=r.data[t],l.textContent=a,o.appendChild(s),o.appendChild(l),n[e].append(o),jQuery(".sw-dash-count").fadeIn().css("display","flex")}else console.log(r),smartwooAddRetryBtn(e,t,a)},error:function(n){let r="Error fetching data: ";n.responseJSON&&n.responseJSON.data&&n.responseJSON.data.message?r+=n.responseJSON.data.message:n.responseText?r+=n.responseText:r+=n,console.error(r),smartwooAddRetryBtn(e,t,a)},complete:function(){fetchIntervals[e]&&clearInterval(fetchIntervals[e]),fetchIntervals[e]=setInterval(()=>{fetchServiceCount(e,t,a)},9e5)}})}function smartwooAddRetryBtn(e,t,a){let n=document.querySelectorAll(".sw-dash-content");smartwoo_clear_dash_content(e);let r=document.createElement("div");r.classList.add("sw-dash-count");let o=document.createElement("h3");o.textContent="Error Occurred",r.append(o);let s=document.createElement("button");s.classList.add("sw-red-button"),s.textContent="retry",s.setAttribute("onclick",`fetchServiceCount(${e}, '${t}', '${a}')`),r.append(s),n[e].append(r),jQuery(".sw-dash-count").fadeIn().css("display","flex"),s.addEventListener("click",()=>{s.style.cursor="progress"})}function smartwoo_clear_dash_content(e){let t=document.querySelectorAll(".sw-dash-content");t&&(t[e].innerHTML="")}function fetchDashboardData(e,t={}){let a=document.querySelector(".sw-dash-content-container");switch(showLoadingIndicator(),e){case 0:realAction="all_services_table";break;case 1:realAction="all_pending_services_table";break;case 2:realAction="all_active_services_table";break;case 3:realAction="all_active_nr_services_table";break;case 4:realAction="all_due_services_table";break;case 5:realAction="all_on_grace_services_table";break;case 6:realAction="all_expired_services_table";break;case 7:realAction="all_cancelled_services_table";break;case 8:realAction="all_suspended_services_table";break;default:realAction="sw_search"}if("all_pending_services_table"===realAction){window.location.href=smartwoo_admin_vars.admin_order_page;return}let n=t.limit||10,r=t.paged||1;jQuery.ajax({type:"GET",url:smartwoo_admin_vars.ajax_url,data:{action:"smartwoo_dashboard",security:smartwoo_admin_vars.security,real_action:realAction,limit:n,paged:r,search_term:"sw_search"===realAction?t.search:""},success:function(t){if(t.success){let a=t.data.all_services_table,n=a.table_header,r=a.table_body,o=a.row_names,s;renderTable(n,r,o,a.total_pages,a.current_page,e)}},error:function(e){var t="Error fetching data: ";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?t+=e.responseJSON.data.message:e.responseText?t+=e.responseText:t+=e,console.error(t)},complete:function(){a&&(a.style.display="none"),hideLoadingIndicator()}})}function smartwooDeleteInvoice(e){confirm("Do you realy want to delete this invoice? This action cannot be reversed!")&&(spinner=smartWooAddSpinner("sw-delete-button"),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"delete_invoice",invoice_id:e,security:smart_woo_vars.security},success:function(e){e.success?(alert(e.data.message),window.location.href=smart_woo_vars.admin_invoice_page):alert(e.data.message)},error:function(e){console.error("Error deleting invoice:",e)},complete:function(){smartWooRemoveSpinner(spinner)}}))}function smartwooProBntAction(e){let t=smartWooAddSpinner("sw-loader");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_pro_button_action",security:smart_woo_vars.security,real_action:e},success(e){if(e.success){let t=document.querySelector(".sw-pro-sell-content");t.innerHTML="";let a=document.createElement("span");a.className="dashicons dashicons-yes-alt";let n=document.createElement("h2");n.textContent=e.data.message,t.append(a),t.append(n),setInterval(()=>a.classList.toggle("loaded"),1e3),setTimeout(()=>{jQuery(t.parentElement).fadeOut(()=>t.remove())},3e3)}else showNotification(e.data.message,3e3),window.location.reload()},error:function(e){let t="Error fetching data: ";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?t+=e.responseJSON.data.message:e.responseText?t+=e.responseText:t+=e,console.error(t)},complete(){smartWooRemoveSpinner(t)}})}function smartwooDeleteProduct(e){confirm("Are you sure you want to permanently delete this product? This action cannot be reversed!")&&(spinner=smartWooAddSpinner("sw-delete-button"),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_delete_product",product_id:e,security:smart_woo_vars.security},success:function(e){e.success?(alert(e.data.message),window.location.href=smart_woo_vars.sw_product_page):alert(e.data.message)},error:function(e){console.error("Error deleting product:",e)},complete:function(){smartWooRemoveSpinner(spinner)}}))}function smartwooDeleteService(e){confirm("Are you sure you want to delete this service? All invoices and assets alocated to it will be lost forever.")&&(spinner=smartWooAddSpinner("sw-delete-button"),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_delete_service",service_id:e,security:smart_woo_vars.security},success:function(e){e.success?(alert(e.data.message),window.location.href=smart_woo_vars.sw_admin_page):alert(e.data.message)},error:function(e){alert("Error deleting service:",e)},complete:function(){smartWooRemoveSpinner(spinner)}}))}function smartwoo_pro_ad(e,t){let a=document.querySelector(".sw-pro-div");a&&a.remove();let n=document.querySelector(".inv-settings-form"),r=document.createElement("div");r.classList.add("sw-pro-div");let o=document.createElement("span");o.classList.add("dashicons","dashicons-dismiss"),o.setAttribute("title","close"),o.style.position="absolute",o.style.right="5px",o.style.top="2px",o.style.color="red",o.style.cursor="pointer";let s=document.createElement("h2");s.textContent=e;let l=document.createElement("div");l.classList.add("sw-pro-body"),l.innerHTML=t;let i=document.createElement("span");i.classList.add("sw-pro-action-btn"),i.textContent="Activate Pro Feature",r.append(s),r.append(o),r.append(l),r.append(i),n.prepend(r),jQuery(r).fadeIn("slow").css("display","flex"),o.addEventListener("click",()=>{r.remove()}),i.addEventListener("click",()=>{window.open(smartwoo_admin_vars.smartwoo_pro_page,"_blank")})}async function smartwooPromptGuestInvoiceData(e){return new Promise(t=>{let a={first_name:"",last_name:"",billing_email:"",billing_company:"",billing_phone:"",billing_address:""},n=document.createElement("div"),r=`<span class="smartwoo-remove dashicons dashicons-no" title="Close"></span>
            <h2>${e}</h2>
            <div class="sw-guest-name-row">
                <input type="text" name="first_name" placeholder="First Name" id="first_name"/>
                <input type="text" name="last_name" placeholder="Last Name" id="last_name"/>
            </div>
            <div class="sw-guest-other-row">
                <input type="text" name="billing_email" placeholder="Billing Email" id="billing_email"/>
                <input type="text" name="billing_company" placeholder="Billing Company" id="billing_company"/>
                <input type="text" name="billing_phone" placeholder="Billing Phone" id="billing_phone">
                <input type="text" name="billing_address" placeholder="Full address" id="billing_address"/>
                <button class="sw-blue-button" style="width: 80%; margin: 10px;">Add Guest</button>

            </div>
        `;n.classList.add("sw-guest-invoice-container"),n.innerHTML=r;let o=document.querySelector("#smartwooInvoiceForm").parentElement,s=document.querySelector("#smartwooInvoiceForm");o.insertBefore(n,s);n.querySelector(".smartwoo-remove").addEventListener("click",()=>{n.remove(),t(!1)});n.querySelector(".sw-blue-button").addEventListener("click",e=>{e.preventDefault(),a.first_name=n.querySelector('input[name="first_name"]').value,a.last_name=n.querySelector('input[name="last_name"]').value,a.billing_address=n.querySelector('input[name="billing_address"]').value,a.billing_phone=n.querySelector('input[name="billing_phone"]').value,a.billing_company=n.querySelector('input[name="billing_company"]').value,a.billing_email=n.querySelector('input[name="billing_email"]').value,t(a),n.remove()})})}document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".sw-dash-content-container"),t=document.querySelectorAll(".sw-dash-content"),a=document.getElementById("dashOrderBtn"),n=document.getElementById("dashAddNew"),r=document.getElementById("dashInvoicesBtn"),o=document.getElementById("dashProductBtn"),s=document.getElementById("dashSettingsBtn"),l=document.querySelectorAll(".sw-upgrade-to-pro"),i=document.getElementById("sw_service_search"),c=document.getElementById("swSearchBtn"),d=document.getElementById("search-notification"),u=document.querySelector(".sw-admin-menu-icon"),p=document.querySelectorAll(".delete-invoice-button"),m=document.querySelectorAll(".sw-delete-product"),h=document.querySelector(".delete-service-button"),v=document.querySelector(".sw-admin-dash-header"),y=document.querySelectorAll(".sw-edit-mail-nopro"),f=document.querySelectorAll(".sw-checkboxes"),w=document.getElementById("sw-hide"),b=document.querySelectorAll(".smartwoo-prevent-default"),g=document.querySelector("#smartwoo-pro-remind-later"),E=document.querySelector("#smartwoo-pro-dismiss-fornow"),S=document.querySelector("#user_data"),L=document.querySelector("#smartwooInvoiceForm"),$=document.querySelectorAll(".sw-toggle-btn"),x=document.querySelectorAll(".smartwoo-admin-invoice-action-div button"),k=document.querySelector(".smartwoo-admin-invoice-action-div"),q=document.querySelector(".smartwoo-admin-invoice-actions");if(e){let C=document.getElementById("contextual-help-link-wrap"),A=document.getElementById("contextual-help-wrap"),T=document.getElementById("contextual-help-columns");C&&(C.style.zIndex="9999",A.style.zIndex="9999",C.style.top="110px",C.style.right="1px",T.style.backgroundColor="#f9f9f9",T.style.border="solid blue 1px",C.style.position="absolute");for(let B=0;B<8;B++)e.append(t[0].cloneNode(!0));let I=[fetchServiceCount(0,"total_services","All Services"),fetchServiceCount(1,"total_pending_services","Pending Service Orders"),fetchServiceCount(2,"total_active_services","Active Services"),fetchServiceCount(3,"total_active_nr_services","Active No Renewal"),fetchServiceCount(4,"total_due_services","Due for Renewal"),fetchServiceCount(5,"total_on_grace_services","Grace Period"),fetchServiceCount(6,"total_expired_services","Expired Services"),fetchServiceCount(7,"total_cancelled_services","Cancelled Services"),fetchServiceCount(8,"total_suspended_services","Suspended Services")];Promise.allSettled(I).finally(()=>{document.dispatchEvent(new CustomEvent("SmartWooDashboardLoaded"))})}if(n&&n.addEventListener("click",()=>{window.location.href=smartwoo_admin_vars.new_service_page}),a&&a.addEventListener("click",()=>{window.location.href=smartwoo_admin_vars.admin_order_page}),r&&r.addEventListener("click",()=>{window.location.href=smartwoo_admin_vars.admin_invoice_page}),o&&o.addEventListener("click",()=>{window.location.href=smartwoo_admin_vars.sw_product_page}),s&&s.addEventListener("click",()=>{window.location.href=smartwoo_admin_vars.sw_options_page}),l&&l.forEach(e=>{e.addEventListener("click",()=>{window.open(smartwoo_admin_vars.smartwoo_pro_page,"_blank")})}),i&&c&&d&&(i.addEventListener("input",()=>{let e=i.value.trim();0==e.length?c.style.cursor="not-allowed":(c.style.cursor="pointer",d.style.display="none")}),c.addEventListener("click",()=>{let e=i.value.trim();e.length>0?(fetchDashboardData("sw_search",{search:e}),d.style.display="none"):(d.textContent="Search field cannot be empty.",d.style.display="block"),d.addEventListener("click",()=>{d.style.display="none"})})),u){let D=!1;u.addEventListener("click",()=>{let e=document.querySelector(".sw-admin-dash-nav");D?jQuery(e).fadeIn().css("display","none"):jQuery(e).fadeIn().css("display","flex"),D=!D})}if(p&&0!==p.length&&p.forEach(e=>{let t=e.parentElement.querySelectorAll("a button"),a=e.getAttribute("data-invoice-id");e.classList.add("sw-icon-button-admin"),t.forEach(e=>{e.classList.add("sw-icon-button-admin")}),e.addEventListener("click",()=>{smartwooDeleteInvoice(a)})}),m&&0!==m.length&&m.forEach(e=>{let t=e.parentElement.querySelectorAll("a button"),a=e.getAttribute("data-product-id");e.classList.add("sw-icon-button-admin"),t.forEach(e=>{e.classList.add("sw-icon-button-admin")}),e.addEventListener("click",()=>{smartwooDeleteProduct(a)})}),h){let P=h.parentElement.querySelectorAll("a button"),_=h.getAttribute("data-service-id");P.forEach(e=>{e.classList.add("sw-icon-button-admin")}),h.classList.add("sw-icon-button-admin"),h.addEventListener("click",()=>{smartwooDeleteService(_)})}if(v&&window.innerWidth<=600&&document.addEventListener("scroll",()=>{window.scrollY>0?(v.style.top="0",v.style.padding="-5px"):v.style.top="20px"}),y&&y.forEach(e=>{e.addEventListener("click",()=>{smartwoo_pro_ad("Email Template Edit","Email template editing is exclusively available in Smart Woo Pro")})}),f&&f.forEach(e=>{e.addEventListener("mouseover",()=>{e.checked?e.setAttribute("title","disable"):e.setAttribute("title","enable")})}),w&&(w.style.cursor="pointer",w.addEventListener("click",e=>{e.preventDefault(),jQuery(w.parentElement).fadeOut()})),b&&b.forEach(e=>{let t=null;e.addEventListener("click",a=>{a.preventDefault(),(t=window.open("","_blank")).location.href=e.getAttribute("href"),e.disabled=!0;let n=()=>{t&&t.closed&&(e.disabled=!1,e.style.cursor="pointer",document.removeEventListener("scroll",n))};document.addEventListener("scroll",n),e.disabled&&(e.style.cursor="not-allowed")})}),g&&g.addEventListener("click",()=>{smartwooProBntAction("remind_later")}),E&&E.addEventListener("click",()=>{smartwooProBntAction("dismiss_fornow")}),S){let O=!1,N=document.querySelector(".sw-guest-option"),j=document.querySelector(".sw-invoice-form-meta"),R=()=>{j.querySelectorAll("input").forEach(e=>{"is_guest_invoice"===e.name?(e.value="",e.value="no"):e.value=""}),O&&(S.querySelector(`option[value="${O}"]`).remove(),O=!O),N&&(N.remove(),showNotification("The origial invoice owner has been changed",7e3))};S.addEventListener("change",async e=>{if(e.target.value.length&&(N&&N.value)!==e.target.value&&("smartwoo_guest"!==e.target.value&&R(),"smartwoo_guest"===e.target.value)){let t=await smartwooPromptGuestInvoiceData("Enter Guest Details");if(!t){if(N){S.value=N.value;return}R(),S.value="";return}if(!t.billing_email.length){if(showNotification("The billing email is required.",5e3),N){S.value=N.value;return}S.value="";return}let a=`${t.first_name?t.first_name+" "+t.last_name:"Guest"} (${t.billing_email})`,n=`-1|${t.billing_email}`;R();let r=document.createElement("option");r.value=n,r.text=a,S.prepend(r),S.value=r.value,O=n,j.querySelector('input[name="first_name"]').value=t.first_name,j.querySelector('input[name="last_name"]').value=t.last_name,j.querySelector('input[name="billing_address"]').value=t.billing_address,j.querySelector('input[name="billing_phone"]').value=t.billing_phone,j.querySelector('input[name="billing_company"]').value=t.billing_company,j.querySelector('input[name="billing_email"]').value=t.billing_email,j.querySelector('input[name="is_guest_invoice"]').value="yes"}})}if(L&&L.addEventListener("submit",e=>{e.preventDefault();let t=L.querySelector('input[type="submit"]');t.setAttribute("disabled",!0);let a=smartWooAddSpinner("swloader",!0),n=document.getElementById("invoice-errors");n&&n.remove();let r=new FormData(L);r.append("security",smartwoo_admin_vars.security),fetch(smartwoo_admin_vars.ajax_url,{method:"POST",body:r}).then(e=>{if(!e.ok)throw showNotification(e.statusText,6e3),Error(`Error: ${e.status} ${e.statusText}`);return e.json()}).then(e=>{if(e.success)showNotification(e.data.message?e.data.message:"Invoice Created",3e3),setTimeout(()=>{window.location.href=e.data.redirect_url},3e3);else{let a=document.createElement("div");a.id="invoice-errors",a.innerHTML=e.data.htmlContent?e.data.htmlContent:e.data.message,L.parentElement.insertBefore(a,L),window.scrollTo({top:0,left:0,behavior:"smooth"}),t.removeAttribute("disabled")}}).catch(e=>{console.error("Fetch error:",e),t.removeAttribute("disabled")}).finally(()=>{smartWooRemoveSpinner(a)})}),$.length){let J=$[0],M=$[1],H=document.querySelector(".smartwoo-admin-invoice-billing-info"),G=document.querySelector(".smartwoo-admin-invoice-items");J.addEventListener("click",()=>{H.classList.contains("smartwoo-hide")?(H.classList.remove("smartwoo-hide"),J.style.borderBottom="solid #000000"):(H.classList.add("smartwoo-hide"),J.style.borderBottom="none")}),M.addEventListener("click",()=>{G.classList.contains("smartwoo-hide")?(G.classList.remove("smartwoo-hide"),M.style.borderBottom="solid #000000"):(G.classList.add("smartwoo-hide"),M.style.borderBottom="none")})}if(x.length&&x.forEach(e=>{e.addEventListener("click",()=>{let t=document.querySelector("#response-div"),a=t.getAttribute("data-invoice-id"),n=e.getAttribute("data-value");if(t.innerHTML="","send_payment_reminder"===n&&!confirm("Are you sure you want to send a payment reminder email to the user?")||"send_new_email"===n&&!confirm("Are you sure you want to send a new invoice email to the user?"))return;spinner=smartWooAddSpinner("swSpinner",!0);let r=new URL(smartwoo_admin_vars.ajax_url);r.searchParams.append("action","smartwoo_admin_invoice_action"),r.searchParams.append("real_action",n),r.searchParams.append("invoice_id",a),r.searchParams.append("security",smartwoo_admin_vars.security),fetch(r,{method:"GET"}).then(e=>{if(!e.ok)throw showNotification(e.statusText,6e3),Error(`Error: ${e.status} ${e.statusText}`);return e.json()}).then(e=>{if(e.success){if("checkout_order_pay"===n||"paymen_url"===n){let a=document.createElement("h3"),r=document.createElement("input"),o="checkout_order_pay"===n?"Checkout Link":"Payment Link";a.textContent=o,a.style.textAlign="center",r.readOnly=!0,r.style.width="80%";let s=document.createElement("span");s.classList.add("dashicons","dashicons-admin-page"),s.setAttribute("title","copy to clipboard"),s.style.cursor="pointer",r.value=e.data.message,t.appendChild(a),t.appendChild(r),t.appendChild(s),s.addEventListener("click",async()=>{navigator.clipboard.writeText(r.value),showNotification("Copied")})}else t.innerHTML=e.data.message}else t.innerHTML=e.data.message,showNotification(e.data.message,6e3)}).catch(e=>{console.error("Fetch error:",e)}).finally(()=>{smartWooRemoveSpinner(spinner)})})}),q&&k){let F=!1;q.addEventListener("click",()=>{F?(k.style.right="200%",F=!F):(k.style.right="0",F=!F)})}}),document.addEventListener("SmartWooDashboardLoaded",()=>{let e=document.querySelectorAll(".sw-dash-content"),t=document.getElementById("dashboardBtn"),a=document.querySelector(".sw-dash-content-container"),n=document.querySelector(".sw-dash-pro-sell-bg");e.forEach((e,t)=>{e.addEventListener("click",e=>{!e.target.matches(".sw-red-button")&&(smartwooRemoveTable(),fetchDashboardData(t))})}),t.addEventListener("click",()=>{smartwooRemoveTable(),jQuery(a).fadeIn().css("display","flex")}),n&&jQuery(n).fadeIn()});