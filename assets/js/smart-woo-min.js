function openCancelServiceDialog(e,t){var n=prompt("You can either opt out of automatic renewal of "+e+' by typing "cancel billing" or opt out of this service by typing "cancel service". This action cannot be reversed. Please note: our refund and returns policy will apply either way.\n\nPlease enter your choice:\nType "cancel service" to cancel the service\nType "cancel billing" to opt out of automatic service renewal');if(null!==n){var a=null;"cancel service"===n.toLowerCase()?a="sw_cancel_service":"cancel billing"===n.toLowerCase()&&(a="sw_cancel_billing"),null!==a?(showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_cancel_or_optout",security:smart_woo_vars.security,service_id:t,selected_action:a},success:function(){jQuery("#sw-service-quick-action").fadeIn("fast",function(){jQuery(this).text("Done!").slideDown("fast")}),location.reload()},complete:function(){hideLoadingIndicator()}})):alert('Oops! you mis-typed it. Please type "cancel service" or "cancel billing" as instructed.')}return!1}function showLoadingIndicator(){jQuery("#swloader").css("display","block")}function hideLoadingIndicator(){jQuery("#swloader").hide()}function confirmEditAccount(){confirm("Are you sure you want to edit your information?")&&(window.location.href=smart_woo_vars.woo_my_account_edit)}function confirmPaymentMethods(){confirm("Are you sure you want to view your payment methods?")&&(window.location.href=smart_woo_vars.woo_payment_method_edit)}function confirmEditBilling(){confirm("Are you sure you want to edit your billing address?")&&(window.location.href=smart_woo_vars.woo_billing_eddress_edit)}function loadBillingDetails(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_billing_details",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e);var t=document.getElementById("edit-billing-address");t&&t.addEventListener("click",function(){confirmEditBilling()})},complete:function(){hideLoadingIndicator()}})}function loadMyDetails(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_my_details",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e);var t=document.getElementById("edit-account-button"),n=document.getElementById("view-payment-button");t&&t.addEventListener("click",function(){confirmEditAccount()}),n&&n.addEventListener("click",function(){confirmPaymentMethods()})},complete:function(){hideLoadingIndicator()}})}function loadAccountLogs(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_account_logs",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e)},complete:function(){hideLoadingIndicator()}})}function loadTransactionHistory(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_transaction_history",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e)},complete:function(){hideLoadingIndicator()}})}function redirectBasedOnServiceAction(e){var t,n=window.location.href;switch(e){case"upgrade":t="service_upgrade";break;case"downgrade":t="service_downgrade";break;case"buy_new":t="buy_new_service";break;default:t=""}var a=updateQueryStringParameter(n,"service_page",t);a=updateQueryStringParameter(a,"service_action",e),window.location.href=a}function updateQueryStringParameter(e,t,n){var a=RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(a)?e.replace(a,"$1"+t+"="+n+"$2"):e+i+t+"="+n}function deleteProduct(e){if(confirm("Are you sure you want to delete this product?")){var t={action:"delete_sw_product",security:smart_woo_vars.security,product_id:e};jQuery.post(ajaxurl,t,function(e){e.success?(alert("Product deleted successfully!"),location.reload()):alert("Error deleting the product. Please try again.")})}}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sw-left-column a"),t=document.getElementById("first-display");e.forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();var a=e.getAttribute("href").substring(1),i=document.getElementById(a);document.querySelectorAll(".instruction").forEach(function(e){e.style.display="none"}),t.style.display="none",i.style.display="block"})})}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("attach-button"),t=document.getElementById("attachments"),n=document.querySelector(".selected-file-names ul");n&&(e.addEventListener("click",function(){t.click()}),t.addEventListener("change",function(){for(let e of t.files){let a=document.createElement("li");a.textContent=e.name,n.appendChild(a)}}))}),jQuery(document).ready(function(e){e("#billing_cycle").on("change",function(){var n=e(this).val(),a=new Date(e("#start_date").val());if(!isNaN(a.getTime())){if("Monthly"===n){a.setDate(a.getDate()+30);var i=new Date(a);i.setDate(i.getDate()-7),e("#end_date").val(t(a)),e("#next_payment_date").val(t(i))}else if("Quarterly"===n){a.setMonth(a.getMonth()+3);var i=new Date(a);i.setDate(i.getDate()-7),e("#end_date").val(t(a)),e("#next_payment_date").val(t(i))}else if("Six Monthly"===n||"Yearly"===n){a.setMonth(a.getMonth()+("Six Monthly"===n?6:12));var i=new Date(a);i.setDate(i.getDate()-7),e("#end_date").val(t(a)),e("#next_payment_date").val(t(i))}}});function t(e){var t,n=e.getFullYear();return n+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")}}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-service-quick-action");e&&e.addEventListener("click",function(){var t;openCancelServiceDialog(e.dataset.serviceName,e.dataset.serviceId)})}),jQuery(document).ready(function(e){var t;e("#upload_image_button").click(function(n){if(n.preventDefault(),t){t.open();return}(t=wp.media.frames.file_frame=wp.media({title:"Choose Image",button:{text:"Choose Image"},multiple:!1})).on("select",function(){var n=t.state().get("selection").first().toJSON();e("#product_image_id").val(n.id),e("#image_preview").html('<img src="'+n.url+'" style="max-width: 100%;" />')}),t.open()})}),jQuery(document).ready(function(e){function t(){e('select[name="grace_period_unit"]').val()===smart_woo_vars.never_expire_value?(e('input[name="grace_period_number"]').val(""),e('input[name="grace_period_number"]').prop("disabled",!0)):e('input[name="grace_period_number"]').prop("disabled",!1)}t(),e('select[name="grace_period_unit"]').change(function(){t()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-billing-details");e&&e.addEventListener("click",function(){loadBillingDetails()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-load-user-details");e&&e.addEventListener("click",function(){loadMyDetails()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-account-log");e&&e.addEventListener("click",function(){loadAccountLogs()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-load-transaction-history");e&&e.addEventListener("click",function(){loadTransactionHistory()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("service-action-dropdown");e&&e.addEventListener("change",function(){redirectBasedOnServiceAction(this.value)})}),jQuery(document).ready(function(e){e(document).on("click",".delete-invoice-button",function(){var t=e(this).data("invoice-id");confirm("Are you sure you want to delete this invoice?")&&e.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"delete_invoice",invoice_id:t,security:smart_woo_vars.security},success:function(){alert("Invoice deleted successfully!"),window.location.href=smart_woo_vars.admin_invoice_page},error:function(e){console.error("Error deleting invoice:",e)}})})}),jQuery(document).ready(function(e){e(document).on("click",".delete-service-button",function(){var t=e(this).data("service-id");confirm("Are you sure you want to delete this service?")&&e.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_delete_service",service_id:t,security:smart_woo_vars.security},success:function(){alert("Service deleted successfully!"),window.location.href=smart_woo_vars.sw_admin_page},error:function(e){console.error("Error deleting service:",e)}})})}),jQuery(document).ready(function(e){e(document).on("click",".sw-delete-product",function(){var t=e(this).data("product-id");confirm("Are you sure you want to delete this product?")&&e.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_delete_product",product_id:t,security:smart_woo_vars.security},success:function(){alert("Product deleted successfully!"),window.location.href=smart_woo_vars.sw_product_page},error:function(e){console.error("Error deleting product:",e)}})})}),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll(".sw-accordion-btn"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"})}),jQuery(document).ready(function(e){var t=e("#generate-service-id-btn"),n=e("#swloader");t.length&&t.on("click",function(t){t.preventDefault();var a=e("#service-name").val();n.css("display","inline-block"),e.ajax({url:smart_woo_vars.ajax_url,type:"POST",dataType:"text",data:{action:"smartwoo_service_id_ajax",service_name:a,security:smart_woo_vars.security},success:function(t){n.css("display","none"),e("#generated-service-id").val(t)},error:function(e,t,a){n.css("display","none"),console.error(a)}})})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("migrationForm");e&&e.addEventListener("submit",function(t){t.preventDefault(),showLoadingIndicator();var n=new FormData(e);n.append("action","smartwoo_service_migration"),n.append("security",smart_woo_vars.security),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:n,processData:!1,contentType:!1,success:function(e){if(e.success&&e.data){var t=e.data.replace(/#038;/g,"&");window.location.href=t}else console.error("Unexpected response format:",e)},error:function(e,t,n){console.error(n),console.log(t)},complete:function(){hideLoadingIndicator()}})})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwooConfigureProduct"),t=document.querySelector(".sw-blue-button");e&&t&&e.addEventListener("submit",function(n){n.preventDefault(),t.textContent="Processing...";var a=new FormData(e);a.append("action","smartwoo_configure_product"),a.append("security",smart_woo_vars.security),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:a,processData:!1,contentType:!1,success:function(e){if(e.success&&e.data){var t=e.data.replace(/#038;/g,"&");window.location.href=t}else console.error("Unexpected response format:",e)},error:function(e,t,n){console.error(n)}})})});