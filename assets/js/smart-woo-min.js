function smartWooAddSpinner(e,t=!1){let n=t?smart_woo_vars.wp_spinner_gif_2x:smart_woo_vars.wp_spinner_gif,s=document.createElement("div");s.classList.add("loading-spinner"),s.innerHTML='<img src=" '+n+'" alt="Loading...">';let a=document.getElementById(e);return a.appendChild(s),a.parentElement.style.cursor="progress",a.style.display="block",s}function smartWooRemoveSpinner(e){e.parentElement.parentElement.style.cursor="",e.remove()}function showNotification(e,t=1e3){let n=document.createElement("div");n.classList.add("notification"),n.innerHTML=`
        <div class="notification-content">
            <span style="float:right; cursor:pointer; font-weight:bold; color: red;" class="dashicons dashicons-dismiss" onclick="this.parentElement.parentElement.remove()"></span>
            <p>${e}</p>
        </div>
    `,n.style.position="fixed",n.style.top="40px",n.style.left="50%",n.style.width="30%",n.style.fontWeight="bold",n.style.transform="translateX(-50%)",n.style.padding="15px",n.style.backgroundColor="#fff",n.style.color="#333",n.style.border="1px solid #ccc",n.style.borderRadius="5px",n.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.5)",n.style.zIndex="9999999",n.style.textAlign="center",document.body.appendChild(n),t&&setTimeout(()=>{n.remove()},t)}function openCancelServiceDialog(e,t){var n=prompt("You can either opt out of automatic renewal of "+e+' by typing "cancel billing" or opt out of this service by typing "cancel service". This action cannot be reversed. Please note: our refund and returns policy will apply either way.\n\nPlease enter your choice:\nType "cancel service" to cancel the service\nType "cancel billing" to opt out of automatic service renewal');if(null!==n){var s=null;"cancel service"===n.toLowerCase()?s="sw_cancel_service":"cancel billing"===n.toLowerCase()&&(s="sw_cancel_billing"),null!==s?(showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_cancel_or_optout",security:smart_woo_vars.security,service_id:t,selected_action:s},success:function(){jQuery("#sw-service-quick-action").fadeIn("fast",function(){jQuery(this).text("Done!").slideDown("fast")}),location.reload()},complete:function(){hideLoadingIndicator()}})):alert('Oops! you mis-typed it. Please type "cancel service" or "cancel billing" as instructed.')}return!1}function showLoadingIndicator(){jQuery("#swloader").css("display","block"),jQuery("body").css("cursor","progress")}function hideLoadingIndicator(){jQuery("#swloader").css("display","none"),jQuery("body").css("cursor","")}function confirmEditAccount(){confirm("Are you sure you want to edit your information?")&&(window.location.href=smart_woo_vars.woo_my_account_edit)}function confirmPaymentMethods(){confirm("Are you sure you want to view your payment methods?")&&(window.location.href=smart_woo_vars.woo_payment_method_edit)}function confirmEditBilling(){confirm("Are you sure you want to edit your billing address?")&&(window.location.href=smart_woo_vars.woo_billing_eddress_edit)}function loadBillingDetails(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_billing_details",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e);var t=document.getElementById("edit-billing-address");t&&t.addEventListener("click",function(){confirmEditBilling()})},complete:function(){hideLoadingIndicator()}})}function loadMyDetails(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_my_details",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e);var t=document.getElementById("edit-account-button"),n=document.getElementById("view-payment-button");t&&t.addEventListener("click",function(){confirmEditAccount()}),n&&n.addEventListener("click",function(){confirmPaymentMethods()})},complete:function(){hideLoadingIndicator()}})}function loadAccountLogs(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_account_logs",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e)},complete:function(){hideLoadingIndicator()}})}function loadTransactionHistory(){showLoadingIndicator(),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:{action:"load_transaction_history",security:smart_woo_vars.security},success:function(e){jQuery("#ajax-content-container").html(e)},complete:function(){hideLoadingIndicator()}})}function smartwoo_ajax_logout(){let e=document.querySelector(".smartwoo-logout-contaner"),t=document.createElement("div");t.id="spinnerDiv",e.appendChild(t);let n=smartWooAddSpinner("spinnerDiv");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{security:smart_woo_vars.security,action:"smartwoo_ajax_logout"},complete:function(){n.remove(),window.location.reload()}})}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("sw-service-quick-action"),t=document.getElementById("sw-forgot-pwd-btn");e&&e.addEventListener("click",function(){let t;openCancelServiceDialog(e.dataset.serviceName,e.dataset.serviceId)}),t&&t.addEventListener("click",()=>{let e=document.querySelector(".sw-notice").querySelector("p"),t=document.querySelector("#sw-login-btn");e.textContent="Password Reset",t.textContent="Reset Password";let n=document.querySelector("#sw-user-login"),s=document.querySelector("#sw-user-password"),a=document.querySelector("#remember_me");n&&n.parentElement.remove(),s&&s.parentElement.remove(),a&&a.parentElement.remove();let o=document.querySelector(".smartwoo-login-form-notice"),i=document.createElement("div"),r=document.createElement("label"),c=document.createElement("input"),l=this.documentElement.querySelector("#sw-error-div");i.classList.add("smartwoo-login-form-body"),r.classList.add("smartwoo-login-form-label"),r.setAttribute("for","sw-user-login"),r.textContent="Email Address",c.setAttribute("type","text"),c.setAttribute("id","sw-user-login"),c.setAttribute("class","smartwoo-login-input"),c.setAttribute("name","user_login"),i.appendChild(r),i.appendChild(c),o.append(i),l.innerHTML='Enter your email address to request a password reset or you can <a id="sw-login-instead">Login</a> instead.',(loginInstead=document.getElementById("sw-login-instead"))&&loginInstead.addEventListener("click",()=>{window.location.reload()}),t.addEventListener("click",async n=>{if(n.preventDefault(),!c.value.length){showNotification("Email should not be empty");return}let s=new URL(smart_woo_vars.ajax_url);s.searchParams.set("action","smartwoo_password_reset"),s.searchParams.set("user_login",c.value),s.searchParams.set("security",smart_woo_vars.security),e.innerHTML='Password Reset processed <span class="dashicons dashicons-yes-alt" style="color: green; font-size: 25px;"></span>',i.remove(),l.innerHTML="A password reset email will be sent to the account if it exists.",t.remove();try{let a=await fetch(s,{method:"GET"});if(!a.ok)throw Error(`Response status: ${a.status}`)}catch{}})})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("sw-billing-details");e&&e.addEventListener("click",function(){loadBillingDetails()})}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("sw-load-user-details");e&&e.addEventListener("click",function(){loadMyDetails()});let t=document.getElementById("sw-account-log");t&&t.addEventListener("click",function(){loadAccountLogs()});let n=document.getElementById("sw-load-transaction-history");n&&n.addEventListener("click",function(){loadTransactionHistory()})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwooConfigureProduct"),t=document.querySelector(".sw-blue-button");e&&t&&e.addEventListener("submit",function(n){n.preventDefault();var s=t.textContent;t.textContent="Processing...",t.disabled=!0;var a=new FormData(e);a.append("action","smartwoo_configure_product"),a.append("security",smart_woo_vars.security),jQuery.ajax({type:"POST",url:smart_woo_vars.ajax_url,data:a,processData:!1,contentType:!1,success:function(e){if(e.success&&e.data){var n=e.data.checkout;t.textContent="Product is configured, redirecting to checkout page....",window.location.href=n}else jQuery("#error-container").html(e.data.message),t.textContent=s},error:function(e,n,a){console.error(a),t.textContent=s}})})}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".sw-menu-icon"),t=document.querySelector(".service-navbar"),n=document.querySelector(".smart-woo-logout"),s=document.getElementById("smartwoo-login-form-visible"),a=document.getElementById("smartwoo-login-form-invisible"),o=document.getElementById("sw-user-password"),i=document.querySelectorAll(".sw-admin-service-assets-button, .sw-client-service-assets-button"),r=document.querySelector(".smartwoo-service-renew-button"),c=document.querySelectorAll(".sw-user-status-item"),l=document.querySelector(".mini-card-content");if(e){let d=e.querySelector(".dashicons-menu"),u=document.querySelector(".dashicons.dashicons-no-alt.sw-close-icon");e.addEventListener("click",function(){t.classList.toggle("active"),t.classList.contains("active")?(jQuery(u).show(),u.focus(),d.classList.remove("dashicons-menu"),d.classList.add("dashicons-no")):(d.classList.remove("dashicons-no"),d.classList.add("dashicons-menu"),jQuery(u).hide())}),u.addEventListener("click",t=>{t.preventDefault(),e.click()})}if(c.length&&c.forEach(e=>{e.style.cursor="pointer";let t=e.querySelector("a").getAttribute("href");e.addEventListener("click",()=>{window.location.href=t})}),n){let m=!1;n.addEventListener("click",function(){if(m)jQuery(".smartwoo-logout-frame").fadeOut("slow",()=>{document.querySelector(".smartwoo-logout-frame").remove()});else{let e=document.createElement("div");e.classList.add("smartwoo-logout-frame");let n=document.createElement("div");n.classList.add("smartwoo-logout-contaner"),e.append(n);let s=document.createElement("p");s.textContent="Are sure you want to logout?",n.append(s);let a=document.createElement("div");a.classList.add("smartwoo-logout-btn-container");let o=document.createElement("button");o.classList.add("sw-blue-button"),o.innerHTML='<span class="dashicons dashicons-yes"></span>';let i=document.createElement("button");i.classList.add("sw-red-button"),i.innerHTML='<span class="dashicons dashicons-no-alt"></span>',a.append(i,o),n.append(a),t.insertAdjacentElement("afterend",e),jQuery(e).fadeIn().css("display","block"),i.addEventListener("click",()=>{jQuery(e).fadeOut("slow",()=>{e.remove()}),m=!m}),o.addEventListener("click",smartwoo_ajax_logout),e.addEventListener("click",t=>{t.target===e&&i.click()})}m=!m})}if(s&&a&&o&&(s.addEventListener("click",()=>{s.style.display="none",a.style.display="block",o.setAttribute("type","text")}),a.addEventListener("click",()=>{a.style.display="none",s.style.display="block",o.setAttribute("type","password")})),i.length){let p=document.querySelectorAll(".sw-admin-assets-body-content, .sw-client-assets-body-content"),y=()=>{i.forEach(e=>{e.classList.remove("active")}),p.forEach(e=>{e.classList.add("smartwoo-hide")})};i.forEach((e,t)=>{e.addEventListener("click",e=>{y(),e.target.classList.contains("active")||e.target.classList.add("active"),p[t].classList.toggle("smartwoo-hide")})})}if(r&&r.addEventListener("click",e=>{e.preventDefault(),jQuery("#swloader").show().css("background-color","rgba(129, 128, 128, 0)").text("");let t=smartWooAddSpinner("swloader",!0),n=r.getAttribute("data-service-id"),s=new URL(smart_woo_vars.ajax_url);s.searchParams.set("action","smartwoo_manual_renew"),s.searchParams.set("service_id",n),s.searchParams.set("security",smart_woo_vars.security),fetch(s).then(e=>(e.ok||(console.error(e.statusText),showNotification("Something went wrong...",6e3)),e.json())).then(e=>{e.success?(showNotification(e.data.message,3e3),setTimeout(()=>{window.location.href=e.data.redirect_url},3e3)):(showNotification(e.data.message??"Operation was not successful",3e3),setTimeout(()=>{window.location.reload()},3e3))}).catch(e=>{console.error(e.message)}).finally(()=>{smartWooRemoveSpinner(t),jQuery("#swloader").hide()})}),l){let f=document.querySelector(".sw-mini-card-pagination"),g=f.querySelectorAll("button"),w=g[0],h=g[1],v="any",E=l.getAttribute("limit");smart_woo_vars.is_account_page&&(v="myaccount");let L=(e,t)=>{e=Number(e),l.innerHTML=`
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
				<li class="smartwoo-skeleton"><span class="smartwoo-skeleton-text"></span></li>
			`;let n=new URL(smart_woo_vars.ajax_url);n.searchParams.set("action","get_subscriptions"),n.searchParams.set("limit",t),n.searchParams.set("security",smart_woo_vars.security),n.searchParams.set("context",v),n.searchParams.set("page",e),fetch(n).then(e=>{if(!e.ok)throw Error(`Error unable to fetch service subscriptions [${e.statusText}]`);return e.json()}).then(t=>{let n=t.data.subscriptions??[],s=t.data.pagination;if(l.innerHTML="",n.length?n.forEach(e=>{let t=document.createElement("li");t.innerHTML=`<a href="${e.view_url}" data-status="(${e.status})">${e.name}</a>`,l.appendChild(t)}):l.innerHTML=`<li>${t.data.message}</li>`,s.total_items>=1){if(f.classList.add("has-more"),document.querySelector("#sw-card-counter").textContent=`${s.total_items} items ${e} of ${s.total_pages}`,e>1){let a=e-1;w.setAttribute("page",a),jQuery(w).show()}else jQuery(w).hide();if(e<s.total_pages){let o=e+1;h.setAttribute("page",o),jQuery(h).show()}else jQuery(h).hide()}})};h.addEventListener("click",()=>{L(h.getAttribute("page"),E)}),w.addEventListener("click",()=>{L(w.getAttribute("page"),E)}),L(1,E)}}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwoo-assets-sub-nav");if(e){var t=document.getElementById("smartwoo-sub-info"),n=document.getElementById("smartwoo-sub-assets"),s=e.innerHTML,a=!1;e.addEventListener("click",function(o){a?(e.innerHTML=s,jQuery(t).fadeIn().css("display","flex"),n.style.display="none"):(e.innerHTML='<span class="dashicons dashicons-info-outline"></span> Sub Info',t.style.display="none",jQuery(n).fadeIn().css("display","block")),a=!a})}}),addEventListener("DOMContentLoaded",function(){var e=document.getElementById("smartwooUpdateBtn");e&&e.addEventListener("click",function(){var t=document.getElementById("smartwooNoticeDiv"),n=document.createElement("div"),s=document.createElement("p");n.className="notice notice-success is-dismissible",e.textContent="";var a=smartWooAddSpinner("smartwooUpdateBtn");jQuery.ajax({type:"GET",url:smart_woo_vars.ajax_url,data:{action:"smartwoo_db_update",security:smart_woo_vars.security},success:function(e){s.textContent=e.success?e.data.message:"Background update started",n.appendChild(s),t.replaceWith(n)},error:function(e){var t="Error updating the database: ";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?t+=e.responseJSON.data.message:e.responseText?t+=e.responseText:t+=e,console.error(t)},complete:function(){smartWooRemoveSpinner(a)}})})});